<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
  <TITLE>Elkhound FAQ</TITLE>
  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
  <style type="text/css">
    H1 { font-size: 150% }
    H2 { font-size: 125% }
    H3 { font-size: 100% }
    P.title { font-size: 175% }
    a.toc:link { text-decoration: none }
    a.toc:visited { text-decoration: none }
  </style>
</HEAD>

<body>

<center>
<p class="title"><b>Elkhound Frequently Asked Questions</b></p>
</center>

<p>
This page has answers to questions that I've received and think
might be useful generally.

<h1>Contents</h1>
                          
<p>
<!-- BEGIN CONTENTS -->
<!-- automatically generated by insert-html-toc; do not edit the TOC directly -->
<ul>
  <li><a class="toc" href="#misc">1. Reduction Actions</a>
  <ul>
    <li><a class="toc" href="#execute_pruned_reductions">1.1 Does Elkhound ever run action routines on parses that are not part of a complete parse tree?</a>
    <li><a class="toc" href="#pruned_reduction_exception">1.2 What if a reduction has a side effect?</a>
  </ul>
</ul>
<!-- END CONTENTS -->

<a name="misc"></a>
<h1>1. Reduction Actions</h1>

<a name="execute_pruned_reductions"></a>
<h2>1.1 Does Elkhound ever run action routines on parses that are not part of a complete parse tree?</h2>
<!-- originally from Carl Eastlund -->

<p>
Yes, it does.  The question of whether a given reduction can be part of a
complete parse tree can, in general, only be answered by seeing all of the
input.  So the two choices are to reduce as you go, which is what Elkhound
does, or to build a parse tree/forest and then run all reductions after
parsing is complete.  Elkhound does not do the latter because building a parse
tree slows parsing by a large (~10) constant factor.

<p>
In certain circumstances, Elkhound can determine that an action corresponds
to a parse that is going to fail before processing of the current token
is finished (see <a href="glr.cc">glr.cc</a>, <tt>GLR::canMakeProgress()</tt>).
In such cases, the action is preempted, but this is just a quick hack that
can slightly improve performance.

<a name="pruned_reduction_exception"></a>
<h2>1.2 What if a reduction has a side effect?</h2>
<!-- originally from Carl Eastlund -->

<p>
Original question:
<blockquote>
  We have a scenario where an action routine is run on part of an
  expression - this part is legal on its own, but the subdivision is
  illegal.  The problem is that the action routine raises an exception
  due to context-sensitive invariants.
</blockquote>

<p>
This is an instance of a more general problem: actions that have side
effects.  Elkhound will call the <tt>del</tt> function corresponding to
reductions that are performed and then discarded, but if the action had a
side effect then undoing it in <tt>del</tt> can be very difficult.  Therefore you
have to be careful about using side effects.  Throwing an exception is
essentially an extreme form of side effect from Elkhound's point of view.

<p>
Probably the easiest solution is to delay the activity that leads to
throwing the exception.  The reduction action can build a record of the
reduction, but then postpone further processing until another pass, after
parsing is complete.  As long as this doesn't happen too often, you won't
incur the cost of a complete parse tree.

<p>
Another possibility is to examine the parse tables and see if a grammar
modification can eliminate the nondeterminism that leads to the parse
split.  This of course requires detailed understanding of how the parsing
algorithm works; it is probably only worth it if performance is crucial.



</body>
</html>
